{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"LC9v7vWHXseM"},"outputs":[],"source":["\"\"\"\n","Author: Ryleigh J. Bruce\n","Date: June 18, 2024\n","\n","Purpose:To load and implement the object localization feature of the YOLOv5 model.\n","\n","\n","Note: The author generated this text in part with GPT-4,\n","OpenAI’s large-scale language-generation model. Upon generating\n","draft code, the authors reviewed, edited, and revised the code\n","to their own liking and takes ultimate responsibility for\n","the content of this code.\n","\n","\"\"\""]},{"cell_type":"markdown","metadata":{"id":"ysby5TACXykc"},"source":["## Module: Mount the Notebook to Google Drive"]},{"cell_type":"markdown","metadata":{"id":"dGp2ucNEXzTI"},"source":["Here we import the drive module that allows us to link the Colab environment with our google drive, where the desired data set is stored. This allows us to access any files located within Google Drive and interact with them directly."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2282,"status":"ok","timestamp":1718726051742,"user":{"displayName":"Ryleigh Bruce","userId":"04866625339349492872"},"user_tz":300},"id":"PVw0HLGgtRUY","outputId":"7307ec5c-5ffa-4efa-ab3e-156f7fa4efd9"},"outputs":[{"name":"stdout","output_type":"stream","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"CO8v6QZr5hW1"},"source":["# Downloading a Dataset from FiftyOne Data Zoo"]},{"cell_type":"markdown","metadata":{"id":"RkPFTzy38Etn"},"source":["First the FiftyOne library must be installed in the colab environment. This is done using the `!pip install` command."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"executionInfo":{"elapsed":59148,"status":"ok","timestamp":1718662239542,"user":{"displayName":"Ryleigh Bruce","userId":"04866625339349492872"},"user_tz":300},"id":"a0rYckXuPGC5","outputId":"7258c136-e51f-437f-a1e8-c86d1ac0da38"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting fiftyone\n","  Downloading fiftyone-0.24.1-py3-none-any.whl (8.2 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m8.2/8.2 MB\u001b[0m \u001b[31m57.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting aiofiles (from fiftyone)\n","  Downloading aiofiles-23.2.1-py3-none-any.whl (15 kB)\n","Collecting argcomplete (from fiftyone)\n","  Downloading argcomplete-3.4.0-py3-none-any.whl (42 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m42.6/42.6 kB\u001b[0m \u001b[31m5.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from fiftyone) (4.12.3)\n","Collecting boto3 (from fiftyone)\n","  Downloading boto3-1.34.128-py3-none-any.whl (139 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m139.2/139.2 kB\u001b[0m \u001b[31m16.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: cachetools in /usr/local/lib/python3.10/dist-packages (from fiftyone) (5.3.3)\n","Collecting dacite<1.8.0,>=1.6.0 (from fiftyone)\n","  Downloading dacite-1.7.0-py3-none-any.whl (12 kB)\n","Collecting Deprecated (from fiftyone)\n","  Downloading Deprecated-1.2.14-py2.py3-none-any.whl (9.6 kB)\n","Collecting ftfy (from fiftyone)\n","  Downloading ftfy-6.2.0-py3-none-any.whl (54 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m54.4/54.4 kB\u001b[0m \u001b[31m7.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: humanize in /usr/local/lib/python3.10/dist-packages (from fiftyone) (4.7.0)\n","Collecting hypercorn>=0.13.2 (from fiftyone)\n","  Downloading hypercorn-0.17.3-py3-none-any.whl (61 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m61.7/61.7 kB\u001b[0m \u001b[31m8.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting Jinja2==3.0.3 (from fiftyone)\n","  Downloading Jinja2-3.0.3-py3-none-any.whl (133 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m133.6/133.6 kB\u001b[0m \u001b[31m17.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting kaleido!=0.2.1.post1 (from fiftyone)\n","  Downloading kaleido-0.2.1-py2.py3-none-manylinux1_x86_64.whl (79.9 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m79.9/79.9 MB\u001b[0m \u001b[31m9.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (from fiftyone) (3.7.1)\n","Collecting mongoengine==0.24.2 (from fiftyone)\n","  Downloading mongoengine-0.24.2-py3-none-any.whl (108 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m108.9/108.9 kB\u001b[0m \u001b[31m6.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting motor>=2.5 (from fiftyone)\n","  Downloading motor-3.4.0-py3-none-any.whl (74 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m74.3/74.3 kB\u001b[0m \u001b[31m9.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from fiftyone) (1.25.2)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from fiftyone) (24.1)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from fiftyone) (2.0.3)\n","Requirement already satisfied: Pillow>=6.2 in /usr/local/lib/python3.10/dist-packages (from fiftyone) (9.4.0)\n","Requirement already satisfied: plotly>=4.14 in /usr/local/lib/python3.10/dist-packages (from fiftyone) (5.15.0)\n","Collecting pprintpp (from fiftyone)\n","  Downloading pprintpp-0.4.0-py2.py3-none-any.whl (16 kB)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from fiftyone) (5.9.5)\n","Collecting pymongo>=3.12 (from fiftyone)\n","  Downloading pymongo-4.7.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (669 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m669.1/669.1 kB\u001b[0m \u001b[31m26.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pytz in /usr/local/lib/python3.10/dist-packages (from fiftyone) (2023.4)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.10/dist-packages (from fiftyone) (6.0.1)\n","Requirement already satisfied: regex in /usr/local/lib/python3.10/dist-packages (from fiftyone) (2024.5.15)\n","Collecting retrying (from fiftyone)\n","  Downloading retrying-1.3.4-py3-none-any.whl (11 kB)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (from fiftyone) (1.2.2)\n","Requirement already satisfied: scikit-image in /usr/local/lib/python3.10/dist-packages (from fiftyone) (0.19.3)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from fiftyone) (1.11.4)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from fiftyone) (67.7.2)\n","Collecting sseclient-py<2,>=1.7.2 (from fiftyone)\n","  Downloading sseclient_py-1.8.0-py2.py3-none-any.whl (8.8 kB)\n","Collecting sse-starlette<1,>=0.10.3 (from fiftyone)\n","  Downloading sse_starlette-0.10.3-py3-none-any.whl (8.0 kB)\n","Collecting starlette>=0.24.0 (from fiftyone)\n","  Downloading starlette-0.37.2-py3-none-any.whl (71 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m71.9/71.9 kB\u001b[0m \u001b[31m7.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting strawberry-graphql==0.138.1 (from fiftyone)\n","  Downloading strawberry_graphql-0.138.1-py3-none-any.whl (192 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m192.5/192.5 kB\u001b[0m \u001b[31m20.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tabulate in /usr/local/lib/python3.10/dist-packages (from fiftyone) (0.9.0)\n","Collecting xmltodict (from fiftyone)\n","  Downloading xmltodict-0.13.0-py2.py3-none-any.whl (10.0 kB)\n","Collecting universal-analytics-python3<2,>=1.0.1 (from fiftyone)\n","  Downloading universal_analytics_python3-1.1.1-py3-none-any.whl (10 kB)\n","Collecting fiftyone-brain<0.17,>=0.16.1 (from fiftyone)\n","  Downloading fiftyone_brain-0.16.1-py3-none-any.whl (89 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m89.6/89.6 kB\u001b[0m \u001b[31m11.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting fiftyone-db<2.0,>=0.4 (from fiftyone)\n","  Downloading fiftyone_db-1.1.3.tar.gz (7.9 kB)\n","  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Collecting voxel51-eta<0.13,>=0.12.6 (from fiftyone)\n","  Downloading voxel51_eta-0.12.6-py2.py3-none-any.whl (942 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m942.9/942.9 kB\u001b[0m \u001b[31m63.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: opencv-python-headless in /usr/local/lib/python3.10/dist-packages (from fiftyone) (4.10.0.82)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from Jinja2==3.0.3->fiftyone) (2.1.5)\n","Collecting graphql-core<3.3.0,>=3.2.0 (from strawberry-graphql==0.138.1->fiftyone)\n","  Downloading graphql_core-3.2.3-py3-none-any.whl (202 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m202.9/202.9 kB\u001b[0m \u001b[31m22.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: python-dateutil<3.0.0,>=2.7.0 in /usr/local/lib/python3.10/dist-packages (from strawberry-graphql==0.138.1->fiftyone) (2.8.2)\n","Requirement already satisfied: typing_extensions<5.0.0,>=3.7.4 in /usr/local/lib/python3.10/dist-packages (from strawberry-graphql==0.138.1->fiftyone) (4.12.2)\n","Requirement already satisfied: exceptiongroup>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from hypercorn>=0.13.2->fiftyone) (1.2.1)\n","Collecting h11 (from hypercorn>=0.13.2->fiftyone)\n","  Downloading h11-0.14.0-py3-none-any.whl (58 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.3/58.3 kB\u001b[0m \u001b[31m7.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting h2>=3.1.0 (from hypercorn>=0.13.2->fiftyone)\n","  Downloading h2-4.1.0-py3-none-any.whl (57 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.5/57.5 kB\u001b[0m \u001b[31m6.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting priority (from hypercorn>=0.13.2->fiftyone)\n","  Downloading priority-2.0.0-py3-none-any.whl (8.9 kB)\n","Collecting taskgroup (from hypercorn>=0.13.2->fiftyone)\n","  Downloading taskgroup-0.0.0a4-py2.py3-none-any.whl (9.1 kB)\n","Requirement already satisfied: tomli in /usr/local/lib/python3.10/dist-packages (from hypercorn>=0.13.2->fiftyone) (2.0.1)\n","Collecting wsproto>=0.14.0 (from hypercorn>=0.13.2->fiftyone)\n","  Downloading wsproto-1.2.0-py3-none-any.whl (24 kB)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly>=4.14->fiftyone) (8.3.0)\n","Collecting dnspython<3.0.0,>=1.16.0 (from pymongo>=3.12->fiftyone)\n","  Downloading dnspython-2.6.1-py3-none-any.whl (307 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m307.7/307.7 kB\u001b[0m \u001b[31m27.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: anyio<5,>=3.4.0 in /usr/local/lib/python3.10/dist-packages (from starlette>=0.24.0->fiftyone) (3.7.1)\n","Collecting httpx>=0.10.0 (from universal-analytics-python3<2,>=1.0.1->fiftyone)\n","  Downloading httpx-0.27.0-py3-none-any.whl (75 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m75.6/75.6 kB\u001b[0m \u001b[31m10.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting dill (from voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading dill-0.3.8-py3-none-any.whl (116 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m116.3/116.3 kB\u001b[0m \u001b[31m15.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: future in /usr/local/lib/python3.10/dist-packages (from voxel51-eta<0.13,>=0.12.6->fiftyone) (0.18.3)\n","Requirement already satisfied: glob2 in /usr/local/lib/python3.10/dist-packages (from voxel51-eta<0.13,>=0.12.6->fiftyone) (0.7)\n","Collecting jsonlines (from voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading jsonlines-4.0.0-py3-none-any.whl (8.7 kB)\n","Collecting py7zr (from voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading py7zr-0.21.0-py3-none-any.whl (67 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m67.6/67.6 kB\u001b[0m \u001b[31m8.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting rarfile (from voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading rarfile-4.2-py3-none-any.whl (29 kB)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from voxel51-eta<0.13,>=0.12.6->fiftyone) (2.31.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from voxel51-eta<0.13,>=0.12.6->fiftyone) (1.16.0)\n","Requirement already satisfied: sortedcontainers in /usr/local/lib/python3.10/dist-packages (from voxel51-eta<0.13,>=0.12.6->fiftyone) (2.4.0)\n","Requirement already satisfied: tzlocal in /usr/local/lib/python3.10/dist-packages (from voxel51-eta<0.13,>=0.12.6->fiftyone) (5.2)\n","Requirement already satisfied: urllib3 in /usr/local/lib/python3.10/dist-packages (from voxel51-eta<0.13,>=0.12.6->fiftyone) (2.0.7)\n","Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4->fiftyone) (2.5)\n","Collecting botocore<1.35.0,>=1.34.128 (from boto3->fiftyone)\n","  Downloading botocore-1.34.128-py3-none-any.whl (12.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m12.3/12.3 MB\u001b[0m \u001b[31m53.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting jmespath<2.0.0,>=0.7.1 (from boto3->fiftyone)\n","  Downloading jmespath-1.0.1-py3-none-any.whl (20 kB)\n","Collecting s3transfer<0.11.0,>=0.10.0 (from boto3->fiftyone)\n","  Downloading s3transfer-0.10.1-py3-none-any.whl (82 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m82.2/82.2 kB\u001b[0m \u001b[31m10.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: wrapt<2,>=1.10 in /usr/local/lib/python3.10/dist-packages (from Deprecated->fiftyone) (1.14.1)\n","Requirement already satisfied: wcwidth<0.3.0,>=0.2.12 in /usr/local/lib/python3.10/dist-packages (from ftfy->fiftyone) (0.2.13)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->fiftyone) (1.2.1)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib->fiftyone) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib->fiftyone) (4.53.0)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->fiftyone) (1.4.5)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->fiftyone) (3.1.2)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->fiftyone) (2024.1)\n","Requirement already satisfied: networkx>=2.2 in /usr/local/lib/python3.10/dist-packages (from scikit-image->fiftyone) (3.3)\n","Requirement already satisfied: imageio>=2.4.1 in /usr/local/lib/python3.10/dist-packages (from scikit-image->fiftyone) (2.31.6)\n","Requirement already satisfied: tifffile>=2019.7.26 in /usr/local/lib/python3.10/dist-packages (from scikit-image->fiftyone) (2024.5.22)\n","Requirement already satisfied: PyWavelets>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-image->fiftyone) (1.6.0)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->fiftyone) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->fiftyone) (3.5.0)\n","Requirement already satisfied: idna>=2.8 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.4.0->starlette>=0.24.0->fiftyone) (3.7)\n","Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.4.0->starlette>=0.24.0->fiftyone) (1.3.1)\n","Collecting hyperframe<7,>=6.0 (from h2>=3.1.0->hypercorn>=0.13.2->fiftyone)\n","  Downloading hyperframe-6.0.1-py3-none-any.whl (12 kB)\n","Collecting hpack<5,>=4.0 (from h2>=3.1.0->hypercorn>=0.13.2->fiftyone)\n","  Downloading hpack-4.0.0-py3-none-any.whl (32 kB)\n","Requirement already satisfied: certifi in /usr/local/lib/python3.10/dist-packages (from httpx>=0.10.0->universal-analytics-python3<2,>=1.0.1->fiftyone) (2024.6.2)\n","Collecting httpcore==1.* (from httpx>=0.10.0->universal-analytics-python3<2,>=1.0.1->fiftyone)\n","  Downloading httpcore-1.0.5-py3-none-any.whl (77 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m77.9/77.9 kB\u001b[0m \u001b[31m9.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: attrs>=19.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonlines->voxel51-eta<0.13,>=0.12.6->fiftyone) (23.2.0)\n","Collecting texttable (from py7zr->voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading texttable-1.7.0-py2.py3-none-any.whl (10 kB)\n","Collecting pycryptodomex>=3.16.0 (from py7zr->voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading pycryptodomex-3.20.0-cp35-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.1/2.1 MB\u001b[0m \u001b[31m52.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting pyzstd>=0.15.9 (from py7zr->voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading pyzstd-0.16.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (413 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m413.8/413.8 kB\u001b[0m \u001b[31m35.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting pyppmd<1.2.0,>=1.1.0 (from py7zr->voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading pyppmd-1.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (138 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m138.9/138.9 kB\u001b[0m \u001b[31m17.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting pybcj<1.1.0,>=1.0.0 (from py7zr->voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading pybcj-1.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (49 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m49.7/49.7 kB\u001b[0m \u001b[31m7.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multivolumefile>=0.2.3 (from py7zr->voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading multivolumefile-0.2.3-py3-none-any.whl (17 kB)\n","Collecting inflate64<1.1.0,>=1.0.0 (from py7zr->voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading inflate64-1.0.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (93 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m93.1/93.1 kB\u001b[0m \u001b[31m11.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting brotli>=1.1.0 (from py7zr->voxel51-eta<0.13,>=0.12.6->fiftyone)\n","  Downloading Brotli-1.1.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.0/3.0 MB\u001b[0m \u001b[31m79.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->voxel51-eta<0.13,>=0.12.6->fiftyone) (3.3.2)\n","Building wheels for collected packages: fiftyone-db\n","  Building wheel for fiftyone-db (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for fiftyone-db: filename=fiftyone_db-1.1.3-py3-none-manylinux1_x86_64.whl size=42156164 sha256=5536bcd6c9c73a23c32b0d83671af1037774a405f0d2070c207aeb28e96ae742\n","  Stored in directory: /root/.cache/pip/wheels/f3/2b/8b/eda0b425855d8b735aadf596af626e4cd9a1555cfefa4c337c\n","Successfully built fiftyone-db\n","Installing collected packages: texttable, sseclient-py, pprintpp, kaleido, brotli, xmltodict, taskgroup, retrying, rarfile, pyzstd, pyppmd, pycryptodomex, pybcj, priority, multivolumefile, jsonlines, jmespath, Jinja2, inflate64, hyperframe, hpack, h11, graphql-core, ftfy, fiftyone-db, dnspython, dill, Deprecated, dacite, argcomplete, aiofiles, wsproto, strawberry-graphql, starlette, pymongo, py7zr, httpcore, h2, botocore, voxel51-eta, sse-starlette, s3transfer, motor, mongoengine, hypercorn, httpx, fiftyone-brain, universal-analytics-python3, boto3, fiftyone\n","  Attempting uninstall: Jinja2\n","    Found existing installation: Jinja2 3.1.4\n","    Uninstalling Jinja2-3.1.4:\n","      Successfully uninstalled Jinja2-3.1.4\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","torch 2.3.0+cu121 requires nvidia-cublas-cu12==12.1.3.1; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-cuda-cupti-cu12==12.1.105; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-cuda-nvrtc-cu12==12.1.105; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-cuda-runtime-cu12==12.1.105; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-cudnn-cu12==8.9.2.26; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-cufft-cu12==11.0.2.54; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-curand-cu12==10.3.2.106; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-cusolver-cu12==11.4.5.107; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-cusparse-cu12==12.1.0.106; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-nccl-cu12==2.20.5; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\n","torch 2.3.0+cu121 requires nvidia-nvtx-cu12==12.1.105; platform_system == \"Linux\" and platform_machine == \"x86_64\", which is not installed.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed Deprecated-1.2.14 Jinja2-3.0.3 aiofiles-23.2.1 argcomplete-3.4.0 boto3-1.34.128 botocore-1.34.128 brotli-1.1.0 dacite-1.7.0 dill-0.3.8 dnspython-2.6.1 fiftyone-0.24.1 fiftyone-brain-0.16.1 fiftyone-db-1.1.3 ftfy-6.2.0 graphql-core-3.2.3 h11-0.14.0 h2-4.1.0 hpack-4.0.0 httpcore-1.0.5 httpx-0.27.0 hypercorn-0.17.3 hyperframe-6.0.1 inflate64-1.0.0 jmespath-1.0.1 jsonlines-4.0.0 kaleido-0.2.1 mongoengine-0.24.2 motor-3.4.0 multivolumefile-0.2.3 pprintpp-0.4.0 priority-2.0.0 py7zr-0.21.0 pybcj-1.0.2 pycryptodomex-3.20.0 pymongo-4.7.3 pyppmd-1.1.0 pyzstd-0.16.0 rarfile-4.2 retrying-1.3.4 s3transfer-0.10.1 sse-starlette-0.10.3 sseclient-py-1.8.0 starlette-0.37.2 strawberry-graphql-0.138.1 taskgroup-0.0.0a4 texttable-1.7.0 universal-analytics-python3-1.1.1 voxel51-eta-0.12.6 wsproto-1.2.0 xmltodict-0.13.0\n"]}],"source":["!pip install fiftyone"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YJSDdaxU7948"},"outputs":[],"source":["import fiftyone\n","import fiftyone.zoo"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"y4JxE4lC8AIV"},"outputs":[],"source":["export_dir = \"/content/drive/MyDrive/shared-data/Notebook datafiles/Street-view-datasets/Geo-dataset\""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"executionInfo":{"elapsed":8527,"status":"ok","timestamp":1718662732510,"user":{"displayName":"Ryleigh Bruce","userId":"04866625339349492872"},"user_tz":300},"id":"HJ1AYydL5mWM","outputId":"49fd6a3f-3ac9-42c4-e640-6e8820f50ffe"},"outputs":[{"name":"stdout","output_type":"stream","text":["Dataset already downloaded\n"]},{"name":"stderr","output_type":"stream","text":["INFO:fiftyone.zoo.datasets:Dataset already downloaded\n"]},{"name":"stdout","output_type":"stream","text":["Loading existing dataset 'quickstart-geo'. To reload from disk, either delete the existing dataset or provide a custom `dataset_name` to use\n"]},{"name":"stderr","output_type":"stream","text":["INFO:fiftyone.zoo.datasets:Loading existing dataset 'quickstart-geo'. To reload from disk, either delete the existing dataset or provide a custom `dataset_name` to use\n"]},{"name":"stdout","output_type":"stream","text":["Dataset loaded successfully.\n","Directory '/content/drive/MyDrive/shared-data/Notebook datafiles/Street-view-datasets/Geo-dataset' already exists; export will be merged with existing files\n"]},{"name":"stderr","output_type":"stream","text":["WARNING:fiftyone.core.collections:Directory '/content/drive/MyDrive/shared-data/Notebook datafiles/Street-view-datasets/Geo-dataset' already exists; export will be merged with existing files\n"]},{"name":"stdout","output_type":"stream","text":["Exporting samples...\n"]},{"name":"stderr","output_type":"stream","text":["INFO:fiftyone.utils.data.exporters:Exporting samples...\n"]},{"name":"stdout","output_type":"stream","text":[" 100% |████████████████████| 500/500 [8.3s elapsed, 0s remaining, 59.9 docs/s]      \n"]},{"name":"stderr","output_type":"stream","text":["INFO:eta.core.utils: 100% |████████████████████| 500/500 [8.3s elapsed, 0s remaining, 59.9 docs/s]      \n"]},{"name":"stdout","output_type":"stream","text":["Dataset exported to Google Drive at: /content/drive/MyDrive/shared-data/Notebook datafiles/Street-view-datasets/Geo-dataset\n"]}],"source":["try:\n","    # Step 3: Load the dataset\n","    dataset = fiftyone.zoo.load_zoo_dataset(\"quickstart-geo\")\n","    print(\"Dataset loaded successfully.\")\n","\n","    # Step 4: Export the dataset to the specified directory on Google Drive\n","    dataset.export(\n","        export_dir=export_dir,\n","        dataset_type=fiftyone.types.FiftyOneDataset  # You can specify other supported formats as needed\n","    )\n","    print(f\"Dataset exported to Google Drive at: {export_dir}\")\n","\n","except Exception as e:\n","    print(f\"Error loading dataset: {e}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pxaiuYam5rAg"},"outputs":[],"source":["# Export the dataset in YOLO format\n","try:\n","  dataset.export(\n","    export_dir=export_dir,\n","    dataset_type=fiftyone.types.YOLOv5Dataset,\n","    label_field=\"detections\", # This field specifies where the relevant detection labels are stored\n","    split='train'  # This line is optional unless specifically handling splits differently\n","  )\n","  print(\"Dataset exported successfully.\")\n","except Exception as e:\n","  print(f\"Error exporting dataset: {e}\")"]},{"cell_type":"markdown","metadata":{"id":"Tuz2AicB-Ump"},"source":["# Using the Pre-trained YOLOv5 Model"]},{"cell_type":"markdown","metadata":{"id":"feLMBno_LDWT"},"source":["## Module: Loading the YOLOv5 Model"]},{"cell_type":"markdown","metadata":{"id":"e0YgrYjhJKu3"},"source":["In order to install and use the pre-trained YOLOv5 model, the `tensorflow` and `pillow` (PIL) libraries must be installed using the `!pip` package installer. `tensorflow` is an open-source machine learning library used for machine learning tasks and PIL allows scripts to open,manipulate, and save various image formats."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"executionInfo":{"elapsed":8474,"status":"ok","timestamp":1718726062769,"user":{"displayName":"Ryleigh Bruce","userId":"04866625339349492872"},"user_tz":300},"id":"3ttNR3lxqVrA","outputId":"6d9b71e0-2c63-498e-984c-f248d52ad6d3"},"outputs":[{"name":"stdout","output_type":"stream","text":["Requirement already satisfied: tensorflow in /usr/local/lib/python3.10/dist-packages (2.15.0)\n","Requirement already satisfied: pillow in /usr/local/lib/python3.10/dist-packages (10.3.0)\n","Requirement already satisfied: absl-py>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.4.0)\n","Requirement already satisfied: astunparse>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.6.3)\n","Requirement already satisfied: flatbuffers>=23.5.26 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (24.3.25)\n","Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.5.4)\n","Requirement already satisfied: google-pasta>=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.2.0)\n","Requirement already satisfied: h5py>=2.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.9.0)\n","Requirement already satisfied: libclang>=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (18.1.1)\n","Requirement already satisfied: ml-dtypes~=0.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.2.0)\n","Requirement already satisfied: numpy<2.0.0,>=1.23.5 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.25.2)\n","Requirement already satisfied: opt-einsum>=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.3.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from tensorflow) (24.1)\n","Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.20.3)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from tensorflow) (67.7.2)\n","Requirement already satisfied: six>=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.16.0)\n","Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.4.0)\n","Requirement already satisfied: typing-extensions>=3.6.6 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (4.12.2)\n","Requirement already satisfied: wrapt<1.15,>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.14.1)\n","Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.37.0)\n","Requirement already satisfied: grpcio<2.0,>=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.64.1)\n","Requirement already satisfied: tensorboard<2.16,>=2.15 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.2)\n","Requirement already satisfied: tensorflow-estimator<2.16,>=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.0)\n","Requirement already satisfied: keras<2.16,>=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.0)\n","Requirement already satisfied: wheel<1.0,>=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse>=1.6.0->tensorflow) (0.43.0)\n","Requirement already satisfied: google-auth<3,>=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.16,>=2.15->tensorflow) (2.27.0)\n","Requirement already satisfied: google-auth-oauthlib<2,>=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.16,>=2.15->tensorflow) (1.2.0)\n","Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.16,>=2.15->tensorflow) (3.6)\n","Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.16,>=2.15->tensorflow) (2.32.3)\n","Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.16,>=2.15->tensorflow) (0.7.2)\n","Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.16,>=2.15->tensorflow) (3.0.3)\n","Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.16,>=2.15->tensorflow) (5.3.3)\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.16,>=2.15->tensorflow) (0.4.0)\n","Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.16,>=2.15->tensorflow) (4.9)\n","Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib<2,>=0.5->tensorboard<2.16,>=2.15->tensorflow) (1.3.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.16,>=2.15->tensorflow) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.16,>=2.15->tensorflow) (2.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.16,>=2.15->tensorflow) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.16,>=2.15->tensorflow) (2023.7.22)\n","Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug>=1.0.1->tensorboard<2.16,>=2.15->tensorflow) (2.1.5)\n","Requirement already satisfied: pyasn1<0.7.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.16,>=2.15->tensorflow) (0.6.0)\n","Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<2,>=0.5->tensorboard<2.16,>=2.15->tensorflow) (3.2.2)\n"]}],"source":["!pip install tensorflow pillow"]},{"cell_type":"markdown","metadata":{"id":"glQTkq-dLBwY"},"source":["The `os` and `shutil` modules are both critical for higher level file operations."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ASMhGXL8Lpxq"},"outputs":[],"source":["import os\n","import shutil"]},{"cell_type":"markdown","metadata":{"id":"h1kXgTBvNTGq"},"source":["The ‘if’ block begins by using the `os` module to check if the `/content/yolov5` path already exists on the file system, and if the condition evaluates to True then the `shutil` module is used to delete the directory to prevent potential error messages."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fLDTiJmiLqIE"},"outputs":[],"source":["# If the yolov5 directory already exists, remove it to avoid conflicts\n","if os.path.exists('/content/yolov5'):\n","    shutil.rmtree('/content/yolov5')"]},{"cell_type":"markdown","metadata":{"id":"eOZrvpnqUcxg"},"source":["Here the `!git` command from the Git version control system used to copy the YOLOv5 repository from the GitHub server and clone it into the specified directory on the local machine (in this case the path for the directory is `/content/yolov5`)."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"P2XGn8u8LtGK"},"outputs":[],"source":["# Clone YOLOv5 repository\n","!git clone https://github.com/ultralytics/yolov5 /content/yolov5"]},{"cell_type":"markdown","source":["This line of code uses the `%` magic command unique to Jupyter Notebooks. `cd` changes the current working directory in the notebook environment to the directory specified in the file path."],"metadata":{"id":"lEX_VSbpYFRb"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"J5BUytSHLuzW"},"outputs":[],"source":["# Change directory to the cloned YOLOv5 repo\n","%cd /content/yolov5"]},{"cell_type":"markdown","source":["`git pull` updates the local repository with the latest changes from the remote repository."],"metadata":{"id":"zlFhBADoem6W"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"g0gqM7M_LwSa"},"outputs":[],"source":["# Pull the latest changes\n","!git pull"]},{"cell_type":"markdown","source":["Here the `!pip` installer is used to install several required packages. The first line uses `-r` to tell pip to install all of the packages listed in the `requirements.txt` file. The `ultralytics`  and `torch`, `torchvision`, and `torchaudio` packages are then installed using the `--quiet` command to ensure only essential information is displayed."],"metadata":{"id":"lI9kNyesenYo"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"_XW_w04bLx1r"},"outputs":[],"source":["# Install the required packages\n","!pip install -r requirements.txt\n","!pip install ultralytics --quiet\n","!pip install torch torchvision torchaudio --quiet"]},{"cell_type":"markdown","source":["Next the `torch`, `pillow`, `os`, and `pandas` modules must be imported for later use."],"metadata":{"id":"ArZEupfbenpy"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"zWp9tXFYLzOd"},"outputs":[],"source":["# Import necessary libraries\n","import torch\n","from PIL import Image, ImageDraw, ImageFont\n","import os\n","import pandas as pd"]},{"cell_type":"markdown","source":["Here the `torch.hub.load` function is used to load the YOLOv5 model from the specified directory. Since there are multiple versions of the YOLOv5 model, the second argument specifies that the YOLOv5s variant should be loaded.`pretrained=True` indicates that  a pre trained version of the YOLOv5s model should be loaded into the model variable."],"metadata":{"id":"Vf9gLpg4en36"}},{"cell_type":"markdown","source":["The `torch.cuda.is_available()` function checks if a CUDA-compatible GPU is available on the local machine, and returns ‘cuda’ if GPU is available (otherwise returning ‘cpu’). Appending `.eval` to the end of the function sets the model into evaluation mode to ensure that it behaves correctly when making predictions."],"metadata":{"id":"VUYNp-E4dG18"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"wmpY93SfL14e"},"outputs":[],"source":["# Load the YOLOv5 model from Torch Hub\n","model = torch.hub.load('ultralytics/yolov5', 'yolov5s', pretrained=True)\n","model.to('cuda' if torch.cuda.is_available() else 'cpu').eval()"]},{"cell_type":"markdown","source":["This line of code determines the names of the classes available for detection through the loaded YOLOv5s model and stores them in the `class_names` variable."],"metadata":{"id":"KGlqREUEeoVz"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"K-MAzQFhL2lv"},"outputs":[],"source":["# Get class names directly from the model\n","class_names = model.names"]},{"cell_type":"markdown","metadata":{"id":"NyVnVLctL5PE"},"source":["## Module: Implementing the Object Localization Feature on a Dataset of Images"]},{"cell_type":"markdown","source":["Several functions must be defined before the YOLOv5 model can be used to generate a series of predictions."],"metadata":{"id":"NUqXnHuKeCD5"}},{"cell_type":"markdown","source":["The `get_predictions` function defined below begins with a ‘try’ block that takes an image and converts it to the RGB color space and stores the result in the `img` variable. The ‘except’ block ensures that if there are any errors with opening the file a corresponding error message is printed."],"metadata":{"id":"t31M4Te-hiRs"}},{"cell_type":"markdown","source":["`results = model(img)` uses the model to process the information stored in the `img` variable and stores the raw detection results in the `results` variable for further processing. The information is then converted into a dataframe with bounding box coordinates using the `Pandas` library."],"metadata":{"id":"c4vlNCU1ht06"}},{"cell_type":"markdown","source":["`predictions = []` initializes an empty list to store the analyzed prediction results. The script then iterates through each row of the dataframe to retrieve the class name, detection confidence, and bounding box coordinates, and then adds a tuple containing this information to the `predictions` list."],"metadata":{"id":"-VxUQ-BChz9r"}},{"cell_type":"markdown","source":["The final line of the code block returns the completed `predictions` list for each detected object in the image."],"metadata":{"id":"xzeVeQY1h9ZG"}},{"cell_type":"code","source":["def get_predictions(img_path):\n","    try:\n","        img = Image.open(img_path).convert('RGB')\n","    except IOError:\n","        print(f\"Error: Could not open {img_path}\")\n","        return []\n","    results = model(img)\n","    results = results.pandas().xyxy[0]\n","    predictions = []\n","    for _, row in results.iterrows():\n","        class_name = class_names[int(row['class'])]\n","        conf = row['confidence']\n","        bbox = [int(row['xmin']), int(row['ymin']), int(row['xmax']), int(row['ymax'])]\n","        predictions.append((class_name, conf, bbox))\n","    return predictions"],"metadata":{"id":"X6vPl8MSdyK9"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Next the `draw_text_with_outline` function must be defined to ensure the images have legible prediction labels."],"metadata":{"id":"jUS1GZHXeCn3"}},{"cell_type":"markdown","source":["The function contains several parameters: `draw` (used to draw on images), `position` (a tuple containing the x, y coordinates of where the text should be drawn), `text` (the string to be drawn), `font` (the font used for the label), `text_color` (the color of the main text), `outline_color` (the color of the text outline), and `outline_width` (the width of the outline in pixels). `x, y = position` decomposes the position tuple into x and y coordinates."],"metadata":{"id":"5I_uMtX2lHF5"}},{"cell_type":"markdown","source":["The ‘for’ loop draws the text at slightly offset positions to create an outline effect around the main text, making it more legible in different image lighting and environmental conditions."],"metadata":{"id":"LLt0724HlSWq"}},{"cell_type":"markdown","source":["The `draw.text((x, y)..)` function draws the main text at the specified `x, y` coordinates on top of the outline using text_color."],"metadata":{"id":"s-q8A2WFlVAU"}},{"cell_type":"code","source":["def draw_text_with_outline(draw, position, text, font, text_color, outline_color, outline_width):\n","    x, y = position\n","    # Draw the outline by drawing text in the outline_color slightly offset in each direction\n","    for offset in range(-outline_width, outline_width + 1):\n","        draw.text((x + offset, y), text, font=font, fill=outline_color)\n","        draw.text((x - offset, y), text, font=font, fill=outline_color)\n","        draw.text((x, y + offset), text, font=font, fill=outline_color)\n","        draw.text((x, y - offset), text, font=font, fill=outline_color)\n","\n","    # Draw the text in the center in text_color\n","    draw.text((x, y), text, font=font, fill=text_color)"],"metadata":{"id":"2AbzsYzEd0R7"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["The final function that must be defined before making predictions with the YOLO model is the `process_images_in_folder` function.This allows the function to process all the images in a given directory while gracefully handling any potential errors."],"metadata":{"id":"0x-V0PiAeDIm"}},{"cell_type":"markdown","source":["The function begins by listing the acceptable image extensions in the `img_exts` list. Then the script checks if the output directory already exists, and uses the `os` module to create one if it doesn’t."],"metadata":{"id":"FPit7KHkozFp"}},{"cell_type":"markdown","source":["A ‘for’ loop iterates over each file in the input folder and checks that each image has a valid extension (one of the extensions listed in the `img_exts` variable). If it encounters a file with an invalid extension then the file is skipped over. The function then uses the `os` module to check the file paths of the images with valid extensions to ensure they are indeed files. The previously defined `get_predictions()` function is then called to get predictions for each image. If predictions are found it proceeds to the next step."],"metadata":{"id":"bajUGPIZo3ZW"}},{"cell_type":"markdown","source":["The ‘try’ block begins by opening the image and converting it to the RGB color space. A specific font in the specified size can then be loaded into the `font` variable, but the script returns to the default font should any errors occur. Another ‘for’ block then loops through each prediction, drawing a rectangle around the detected object and adding text annotations. The function then saves the annotated image to the output folder with a modified filename prefixed with ‘annotated-”."],"metadata":{"id":"R4lQi8Gxo-if"}},{"cell_type":"markdown","source":["The `IOError` catches and handles any potential issues with opening or saving images."],"metadata":{"id":"uAjyWARvpJFt"}},{"cell_type":"markdown","source":["The function then alerts the user when it has finished processing and saving all of the images."],"metadata":{"id":"yyGNT1jDpMN6"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"--yQTYruqLf_"},"outputs":[],"source":["def process_images_in_folder(input_folder_path, output_folder_path):\n","    # List of acceptable image extensions\n","    img_exts = ['.jpg', '.jpeg', '.png', '.bmp', '.tiff', '.gif', '.ico']\n","\n","    if not os.path.exists(output_folder_path):\n","        os.makedirs(output_folder_path)\n","\n","    for filename in os.listdir(input_folder_path):\n","        if not any(filename.lower().endswith(ext) for ext in img_exts):  # Check if the file is an image.\n","            continue  # Skip the current iteration if the file is not an image.\n","        img_path = os.path.join(input_folder_path, filename)\n","        if os.path.isfile(img_path):\n","            predictions = get_predictions(img_path)\n","            if predictions:\n","                try:\n","                    img = Image.open(img_path).convert('RGB')\n","                    draw = ImageDraw.Draw(img)\n","\n","                    # Define font size and font\n","                    font_size = 12  # Adjust this value as needed\n","                    try:\n","                        font = ImageFont.truetype(\"arial.ttf\", font_size)\n","                    except IOError:\n","                        font = ImageFont.load_default()  # Fallback to default font in case of error\n","\n","                    for class_name, conf, bbox in predictions:\n","                        draw.rectangle(bbox, outline='red', width=2)\n","                        draw_text_with_outline(draw, (bbox[0], bbox[1]), f'{class_name} {conf:.2f}', font, 'white', 'red', 2)\n","\n","                    output_path = os.path.join(output_folder_path, f'annotated-{filename}')\n","                    img.save(output_path)\n","                    print(f'Processed {filename}. Annotated image saved.')\n","                except IOError:\n","                    print(f\"Error: Could not process {img_path}\")\n","\n","    print(f\"All images processed. Annotations saved in {output_folder_path}\")"]},{"cell_type":"markdown","source":["The following code block defines the input and output directories to be used in the script."],"metadata":{"id":"hGJ0uVNxeDtw"}},{"cell_type":"code","source":["# Paths to your folders\n","input_folder_path = '/content/drive/MyDrive/shared-data/Notebook datafiles/Street-view-datasets/Geo-dataset/data'  # Path where images are stored\n","output_folder_path = '/content/drive/MyDrive/shared-data/Notebook datafiles/Street-view-datasets/Geo-dataset/pre-trained-anno-2'  # Path where to save images"],"metadata":{"id":"4RfWk-Nud9Bm"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["This final line calls the `process_images_in_folder()` function with the input and output folders as its arguments. This results in the script getting predictions and annotating each image in the input directory, then saving the annotated images to the output directory."],"metadata":{"id":"87e_qMvceEDh"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"executionInfo":{"elapsed":252360,"status":"ok","timestamp":1718726668837,"user":{"displayName":"Ryleigh Bruce","userId":"04866625339349492872"},"user_tz":300},"id":"qZC7W0QkqORQ","outputId":"dbaad1e3-f2a6-4a6c-93ff-927cb1d19d6e"},"outputs":[{"name":"stdout","output_type":"stream","text":["Processed c72d0482-3ae5270e.jpg. Annotated image saved.\n","Processed bf6e127b-cc8a310b.jpg. Annotated image saved.\n","Processed bda48a2c-ea6ab69b.jpg. Annotated image saved.\n","Processed b59dd81f-b8ebeb56.jpg. Annotated image saved.\n","Processed b7147430-2a111946.jpg. Annotated image saved.\n","Processed c5796880-a7005e6e.jpg. Annotated image saved.\n","Processed be56ab92-da00e516.jpg. Annotated image saved.\n","Processed bf1f6e6e-3e47c0f7.jpg. Annotated image saved.\n","Processed c02d91b8-8b1bdadc.jpg. Annotated image saved.\n","Processed c1bd17fc-fc404eba.jpg. Annotated image saved.\n","Processed c3884826-f2da6bd2.jpg. Annotated image saved.\n","Processed c1bf3315-d2d3b34f.jpg. Annotated image saved.\n","Processed ba15261b-46e2755d.jpg. Annotated image saved.\n","Processed c3fd58b6-04bcbef3.jpg. Annotated image saved.\n","Processed bb99539a-4fd21cfa.jpg. Annotated image saved.\n","Processed bf8ff5f5-9ae0cea2.jpg. Annotated image saved.\n","Processed c13b9590-7e14e55c.jpg. Annotated image saved.\n","Processed c08b49d7-b1cea927.jpg. Annotated image saved.\n","Processed c1f5ccf1-3db75c28.jpg. Annotated image saved.\n","Processed b89aded3-23603d87.jpg. Annotated image saved.\n","Processed c8aca1e2-4d35a25a.jpg. Annotated image saved.\n","Processed c1362f73-5aa8acd1.jpg. Annotated image saved.\n","Processed c04246b7-5386e803.jpg. Annotated image saved.\n","Processed c024c31c-9ec7869f.jpg. Annotated image saved.\n","Processed b3899bec-df46f67b.jpg. Annotated image saved.\n","Processed bdd463a8-94969b77.jpg. Annotated image saved.\n","Processed b5df49b8-73e68ecb.jpg. Annotated image saved.\n","Processed c02cb208-81964a07.jpg. Annotated image saved.\n","Processed bcb356f6-520dd65c.jpg. Annotated image saved.\n","Processed b82f91d7-a21bb033.jpg. Annotated image saved.\n","Processed bfae2833-616084f1.jpg. Annotated image saved.\n","Processed bb8e2033-6c418fc7.jpg. Annotated image saved.\n","Processed c3639d96-271bbe4c.jpg. Annotated image saved.\n","Processed ba31ed47-117c074b.jpg. Annotated image saved.\n","Processed bb2c8f70-d58d2ef6.jpg. Annotated image saved.\n","Processed c992d89e-63020be4.jpg. Annotated image saved.\n","Processed bcde71de-ac5c8c74.jpg. Annotated image saved.\n","Processed b53f23c3-3d2cea8b.jpg. Annotated image saved.\n","Processed c1d28a8a-6ce21619.jpg. Annotated image saved.\n","Processed b539383c-b57307bc.jpg. Annotated image saved.\n","Processed bc053dc7-f2d3aa91.jpg. Annotated image saved.\n","Processed b6f4b139-744f76c0.jpg. Annotated image saved.\n","Processed beff1d1c-faff23dd.jpg. Annotated image saved.\n","Processed ca3f4c16-b33f3a0b.jpg. Annotated image saved.\n","Processed c0eb4a02-3b40262b.jpg. Annotated image saved.\n","Processed b47262a4-3c664e48.jpg. Annotated image saved.\n","Processed bdcd6f24-c646d15b.jpg. Annotated image saved.\n","Processed c328b7ab-7a893ba0.jpg. Annotated image saved.\n","Processed c8f48328-7de61e93.jpg. Annotated image saved.\n","Processed c56ad92a-ef30489c.jpg. Annotated image saved.\n","Processed c71a5c66-93c9eca0.jpg. Annotated image saved.\n","Processed c380e9e2-6d8a84be.jpg. Annotated image saved.\n","Processed bbde8dba-93d1eb1f.jpg. Annotated image saved.\n","Processed bf78f601-1003f3da.jpg. Annotated image saved.\n","Processed c1c70561-e47b6c58.jpg. Annotated image saved.\n","Processed c54a2f90-4762b269.jpg. Annotated image saved.\n","Processed bd355fcc-63dd68f2.jpg. Annotated image saved.\n","Processed c8a7a62d-e58e7297.jpg. Annotated image saved.\n","Processed bd626633-ad3626a7.jpg. Annotated image saved.\n","Processed c55ab634-b93da9ef.jpg. Annotated image saved.\n","Processed b5191523-9c2c4c83.jpg. Annotated image saved.\n","Processed bb8a6035-7229656b.jpg. Annotated image saved.\n","Processed b2dbb793-9f0b2bec.jpg. Annotated image saved.\n","Processed bd7f150c-c557afa7.jpg. Annotated image saved.\n","Processed bde65a81-fb6b43cc.jpg. Annotated image saved.\n","Processed c3884826-d8789adb.jpg. Annotated image saved.\n","Processed c8c9db85-9d8a90c1.jpg. Annotated image saved.\n","Processed bebb5b76-68384a7d.jpg. Annotated image saved.\n","Processed bdd7c984-3c3a2fc4.jpg. Annotated image saved.\n","Processed bf2a6720-a23c2b5e.jpg. Annotated image saved.\n","Processed be52b29f-337d4ed4.jpg. Annotated image saved.\n","Processed be395d23-22773837.jpg. Annotated image saved.\n","Processed ba1f97fc-5b4826df.jpg. Annotated image saved.\n","Processed b28ec521-834a964c.jpg. Annotated image saved.\n","Processed bcd900a7-02adf687.jpg. Annotated image saved.\n","Processed bc45ad96-42d305c5.jpg. Annotated image saved.\n","Processed bd3dc2ff-243f2c63.jpg. Annotated image saved.\n","Processed ba336fcb-24158015.jpg. Annotated image saved.\n","Processed c2b665b0-204f2f52.jpg. Annotated image saved.\n","Processed c57906c2-0f8c5acb.jpg. Annotated image saved.\n","Processed c503f2e8-55cc08bf.jpg. Annotated image saved.\n","Processed c174b1bd-ff23da83.jpg. Annotated image saved.\n","Processed bde48e24-e9aba0dc.jpg. Annotated image saved.\n","Processed c6ed8102-b74b0fad.jpg. Annotated image saved.\n","Processed b83d7cf3-4e193818.jpg. Annotated image saved.\n","Processed c3dd2df5-e805df01.jpg. Annotated image saved.\n","Processed c3009124-b8d0d1ea.jpg. Annotated image saved.\n","Processed c9c9235f-94e65449.jpg. Annotated image saved.\n","Processed c8b5bc59-7e4f7285.jpg. Annotated image saved.\n","Processed b7a8e795-056b3c79.jpg. Annotated image saved.\n","Processed c3de5a74-899efae7.jpg. Annotated image saved.\n","Processed c9283177-4ac407c3.jpg. Annotated image saved.\n","Processed c80641a4-d91ca4a9.jpg. Annotated image saved.\n","Processed bf527384-894c88c6.jpg. Annotated image saved.\n","Processed c7e25b5f-5c098837.jpg. Annotated image saved.\n","Processed bded2d56-9a09a78b.jpg. Annotated image saved.\n","Processed be047105-0662bd2d.jpg. Annotated image saved.\n","Processed bdcd6f24-e3a675af.jpg. Annotated image saved.\n","Processed c55b79ad-fff7df7b.jpg. Annotated image saved.\n","Processed c6ca1dcf-635b762f.jpg. Annotated image saved.\n","Processed c09af0c6-61c87b58.jpg. Annotated image saved.\n","Processed b967b2a7-2003bfd2.jpg. Annotated image saved.\n","Processed b3563bcf-1962e18d.jpg. Annotated image saved.\n","Processed bdd42bec-c050a953.jpg. Annotated image saved.\n","Processed c5ffb92c-772cfc9c.jpg. Annotated image saved.\n","Processed b6ea1520-1c9df539.jpg. Annotated image saved.\n","Processed bbf3d83d-d6265b06.jpg. Annotated image saved.\n","Processed c36a8dac-908de757.jpg. Annotated image saved.\n","Processed c752e922-4f7bcda0.jpg. Annotated image saved.\n","Processed c75d7961-49f17231.jpg. Annotated image saved.\n","Processed c767ad39-119bf6f3.jpg. Annotated image saved.\n","Processed bbf7e280-19aed161.jpg. Annotated image saved.\n","Processed c7706d20-daa7bd9c.jpg. Annotated image saved.\n","Processed c1a5825c-c2afbdde.jpg. Annotated image saved.\n","Processed baa79505-43ff4345.jpg. Annotated image saved.\n","Processed ba0a827b-dfcec16f.jpg. Annotated image saved.\n","Processed bb2e43e4-5e7a7129.jpg. Annotated image saved.\n","Processed c39b357e-5a90a6b6.jpg. Annotated image saved.\n","Processed b979b89c-d7e084b9.jpg. Annotated image saved.\n","Processed c748c1a1-f1338769.jpg. Annotated image saved.\n","Processed c02d18db-023c1955.jpg. Annotated image saved.\n","Processed b3121071-b9d7694a.jpg. Annotated image saved.\n","Processed b501bb52-7282ae0d.jpg. Annotated image saved.\n","Processed b41d0744-6cabc495.jpg. Annotated image saved.\n","Processed baa50786-e1613030.jpg. Annotated image saved.\n","Processed bc97328c-8b9ba7ab.jpg. Annotated image saved.\n","Processed bcb3c18a-fad48b76.jpg. Annotated image saved.\n","Processed c5588233-b03622f3.jpg. Annotated image saved.\n","Processed b2bdb7b6-602437cb.jpg. Annotated image saved.\n","Processed c6959e96-dd05fa7a.jpg. Annotated image saved.\n","Processed bee09035-01100c39.jpg. Annotated image saved.\n","Processed bde0caa6-d7d428b5.jpg. Annotated image saved.\n","Processed bad7f33d-7e31e0d2.jpg. Annotated image saved.\n","Processed bf0eda09-d1773b85.jpg. Annotated image saved.\n","Processed b4475526-2f0bca11.jpg. Annotated image saved.\n","Processed c6c08fb0-cb0efab6.jpg. Annotated image saved.\n","Processed c58f17ae-e811d801.jpg. Annotated image saved.\n","Processed bba9d58b-afdc737b.jpg. Annotated image saved.\n","Processed bb49071c-b290d284.jpg. Annotated image saved.\n","Processed c8c97803-35a64c37.jpg. Annotated image saved.\n","Processed c9b82f4e-fd73af29.jpg. Annotated image saved.\n","Processed c12ce21f-6f6ecfa7.jpg. Annotated image saved.\n","Processed c553c602-a2d33a0c.jpg. Annotated image saved.\n","Processed b78cb53c-65159143.jpg. Annotated image saved.\n","Processed b37c2955-5f0aef70.jpg. Annotated image saved.\n","Processed be85665c-4fe33b5c.jpg. Annotated image saved.\n","Processed c9b9fef4-a58bf3d5.jpg. Annotated image saved.\n","Processed be9496ad-3d23e714.jpg. Annotated image saved.\n","Processed bd7cb9e1-65b08f46.jpg. Annotated image saved.\n","Processed b415cc29-7371aa85.jpg. Annotated image saved.\n","Processed b4a240e1-6e3cd8b8.jpg. Annotated image saved.\n","Processed befd706d-2e1fe6e1.jpg. Annotated image saved.\n","Processed c4a90af7-02583942.jpg. Annotated image saved.\n","Processed b39fe3cd-398678c5.jpg. Annotated image saved.\n","Processed b9df54a4-314e9e5e.jpg. Annotated image saved.\n","Processed c0db3bd8-17587381.jpg. Annotated image saved.\n","Processed c79687a5-a0f3794d.jpg. Annotated image saved.\n","Processed bf6315ee-a77e1bb2.jpg. Annotated image saved.\n","Processed c06be53b-be47b965.jpg. Annotated image saved.\n","Processed c45b2e04-5689b375.jpg. Annotated image saved.\n","Processed ca5f8e49-0df2e0a1.jpg. Annotated image saved.\n","Processed bf83a7d7-d4c69012.jpg. Annotated image saved.\n","Processed c695fbd3-0a91a52f.jpg. Annotated image saved.\n","Processed c52170ea-5346382f.jpg. Annotated image saved.\n","Processed b39fe3cd-227ff7a8.jpg. Annotated image saved.\n","Processed bbf3d83d-f15c5dd8.jpg. Annotated image saved.\n","Processed c46c8375-44338121.jpg. Annotated image saved.\n","Processed bba94727-03cd03e0.jpg. Annotated image saved.\n","Processed b4b9c39d-6409d1fd.jpg. Annotated image saved.\n","Processed c8650e15-38bef9dc.jpg. Annotated image saved.\n","Processed c73abec5-609ede44.jpg. Annotated image saved.\n","Processed c6549c4a-525a2429.jpg. Annotated image saved.\n","Processed c6a5ec44-7b0e5542.jpg. Annotated image saved.\n","Processed c01eddca-7c14637e.jpg. Annotated image saved.\n","Processed b270d8e4-0f565398.jpg. Annotated image saved.\n","Processed c179d309-8939ab37.jpg. Annotated image saved.\n","Processed bba9d58b-18c62a06.jpg. Annotated image saved.\n","Processed b90a1ed5-653861b3.jpg. Annotated image saved.\n","Processed c8152bfa-28181ba4.jpg. Annotated image saved.\n","Processed b9bdeae4-ee607bbc.jpg. Annotated image saved.\n","Processed b87a03a9-c9da2b1a.jpg. Annotated image saved.\n","Processed b9ef03d3-92a377cc.jpg. Annotated image saved.\n","Processed b3121071-6b1e5be7.jpg. Annotated image saved.\n","Processed bb46f3cd-b72d2152.jpg. Annotated image saved.\n","Processed bb92ddee-aea40f05.jpg. Annotated image saved.\n","Processed c19e69b1-c22bb482.jpg. Annotated image saved.\n","Processed beaa0c22-77f57e18.jpg. Annotated image saved.\n","Processed b928cd75-1fb70c18.jpg. Annotated image saved.\n","Processed c4f993bf-3eee07b1.jpg. Annotated image saved.\n","Processed c94d86ee-9835e761.jpg. Annotated image saved.\n","Processed b1f4491b-16256d7c.jpg. Annotated image saved.\n","Processed bbff5146-4b928b85.jpg. Annotated image saved.\n","Processed c94a5fb6-446b8726.jpg. Annotated image saved.\n","Processed c639e1c0-2eb71da1.jpg. Annotated image saved.\n","Processed c2edec5a-66ae2e42.jpg. Annotated image saved.\n","Processed bb43e180-96b21056.jpg. Annotated image saved.\n","Processed c1243d2d-ea0d84a3.jpg. Annotated image saved.\n","Processed b27cd403-d7616bfa.jpg. Annotated image saved.\n","Processed c889c950-865ca5b6.jpg. Annotated image saved.\n","Processed b44f2475-c80a51b7.jpg. Annotated image saved.\n","Processed c6bb7ee7-9fec7fdb.jpg. Annotated image saved.\n","Processed c4406d9a-1864ada7.jpg. Annotated image saved.\n","Processed c281c4a6-27abfe08.jpg. Annotated image saved.\n","Processed c9c9235f-8c053a4c.jpg. Annotated image saved.\n","Processed bbc755d2-7719fa91.jpg. Annotated image saved.\n","Processed c47f850b-97816a73.jpg. Annotated image saved.\n","Processed c54e3b28-168e2176.jpg. Annotated image saved.\n","Processed c4e8705f-39bf4a26.jpg. Annotated image saved.\n","Processed b26cfcdc-2e290c42.jpg. Annotated image saved.\n","Processed c4742900-1afc30eb.jpg. Annotated image saved.\n","Processed bb71ba86-3204e97e.jpg. Annotated image saved.\n","Processed b9d34460-2c3b1ab3.jpg. Annotated image saved.\n","Processed bf0e0d24-5b11b412.jpg. Annotated image saved.\n","Processed c315b14e-429b1108.jpg. Annotated image saved.\n","Processed c74931cf-0970795a.jpg. Annotated image saved.\n","Processed b6fae313-657598b1.jpg. Annotated image saved.\n","Processed c1eec0f9-986b3a7c.jpg. Annotated image saved.\n","Processed b75da19e-78c2c800.jpg. Annotated image saved.\n","Processed beeaded5-8b3f6201.jpg. Annotated image saved.\n","Processed be40c69d-16a90cda.jpg. Annotated image saved.\n","Processed b1f20aa0-6ef1db42.jpg. Annotated image saved.\n","Processed c4770a97-1393ce84.jpg. Annotated image saved.\n","Processed c6d4654c-caa2d45e.jpg. Annotated image saved.\n","Processed c3981cf1-6e95c296.jpg. Annotated image saved.\n","Processed bc4799bc-bc14f187.jpg. Annotated image saved.\n","Processed c8c6e143-d85ae0f6.jpg. Annotated image saved.\n","Processed c7930146-1a9e5399.jpg. Annotated image saved.\n","Processed b6487a3e-0761a2ae.jpg. Annotated image saved.\n","Processed b7dbe50a-3738a448.jpg. Annotated image saved.\n","Processed bbe95ad4-1df76d9d.jpg. Annotated image saved.\n","Processed c6dad47e-47a61b83.jpg. Annotated image saved.\n","Processed bb9071ac-4ee8ed8c.jpg. Annotated image saved.\n","Processed c0b4f0df-586ab062.jpg. Annotated image saved.\n","Processed b97f47c3-906ebdd5.jpg. Annotated image saved.\n","Processed c57c1efb-660f4ec3.jpg. Annotated image saved.\n","Processed ca479701-2ab57f9a.jpg. Annotated image saved.\n","Processed c3cae07c-ceeefd3f.jpg. Annotated image saved.\n","Processed c121b93f-b2ee73d4.jpg. Annotated image saved.\n","Processed c1797ffb-633a7ed8.jpg. Annotated image saved.\n","Processed c0863b71-8c4ce9be.jpg. Annotated image saved.\n","Processed c8eeb9c9-cdadaee2.jpg. Annotated image saved.\n","Processed b3363496-032f16bf.jpg. Annotated image saved.\n","Processed b3a9281a-8b4f26f1.jpg. Annotated image saved.\n","Processed b9e7e326-693b4ae7.jpg. Annotated image saved.\n","Processed c0d12f7f-1e033ebf.jpg. Annotated image saved.\n","Processed c43052f6-662bb3a2.jpg. Annotated image saved.\n","Processed bea64506-3ce23cff.jpg. Annotated image saved.\n","Processed b46009c2-72be5f8b.jpg. Annotated image saved.\n","Processed b8acc534-23eb2531.jpg. Annotated image saved.\n","Processed b97f9acb-5c677268.jpg. Annotated image saved.\n","Processed b7e8932c-3f90dbfc.jpg. Annotated image saved.\n","Processed c0200910-93adc390.jpg. Annotated image saved.\n","Processed c91a84db-f40ee6d0.jpg. Annotated image saved.\n","Processed b96c88de-058de530.jpg. Annotated image saved.\n","Processed c9a653e3-746daa0d.jpg. Annotated image saved.\n","Processed b9fb5382-76c75580.jpg. Annotated image saved.\n","Processed bffe6c38-d48f5ee5.jpg. Annotated image saved.\n","Processed c2021c8c-474a8eda.jpg. Annotated image saved.\n","Processed baf019d9-986608ff.jpg. Annotated image saved.\n","Processed bbc0f7ea-8623a974.jpg. Annotated image saved.\n","Processed c836d9b9-16a414cd.jpg. Annotated image saved.\n","Processed b87ee3bb-be0b1bb6.jpg. Annotated image saved.\n","Processed bcaf73c1-311f299e.jpg. Annotated image saved.\n","Processed b4fb7979-16f87335.jpg. Annotated image saved.\n","Processed c0f1a2f9-0e16bcb7.jpg. Annotated image saved.\n","Processed beaa00a7-25aba714.jpg. Annotated image saved.\n","Processed b4dd1c23-355940ff.jpg. Annotated image saved.\n","Processed bd026bc5-7d3bf0ef.jpg. Annotated image saved.\n","Processed c69b26c7-3fa6979b.jpg. Annotated image saved.\n","Processed b2dde0d9-1303a9ef.jpg. Annotated image saved.\n","Processed b770f56a-3e8cba7a.jpg. Annotated image saved.\n","Processed c85ca3b9-72a968aa.jpg. Annotated image saved.\n","Processed b7fd3f86-ba8bf79c.jpg. Annotated image saved.\n","Processed c482a775-8e9c09c8.jpg. Annotated image saved.\n","Processed b9e4cb3d-eaf3d4ad.jpg. Annotated image saved.\n","Processed bd6dcefc-3af00f57.jpg. Annotated image saved.\n","Processed be83776d-e07b8fdc.jpg. Annotated image saved.\n","Processed bf9a1430-d4650520.jpg. Annotated image saved.\n","Processed bb087b1c-6c9e904f.jpg. Annotated image saved.\n","Processed c573d709-4a0dbd2a.jpg. Annotated image saved.\n","Processed b95dcb10-45d68fcc.jpg. Annotated image saved.\n","Processed c6e52b8f-eb7a0bd6.jpg. Annotated image saved.\n","Processed be099a06-28b7d23f.jpg. Annotated image saved.\n","Processed c1797ffb-4afdb9c9.jpg. Annotated image saved.\n","Processed c9c9235f-cc8f42ba.jpg. Annotated image saved.\n","Processed c86f5924-26a09613.jpg. Annotated image saved.\n","Processed bcbab238-e79b7395.jpg. Annotated image saved.\n","Processed c7e6bfe9-3256d95a.jpg. Annotated image saved.\n","Processed c8476b52-a66aa1c5.jpg. Annotated image saved.\n","Processed b54735e3-65f77c99.jpg. Annotated image saved.\n","Processed c0f5b0d0-17e0110c.jpg. Annotated image saved.\n","Processed c8062950-e7ac08bd.jpg. Annotated image saved.\n","Processed b2fbc1aa-b6180041.jpg. Annotated image saved.\n","Processed b89581ec-5a14165f.jpg. Annotated image saved.\n","Processed bbe4ec31-2932af48.jpg. Annotated image saved.\n","Processed b685eb37-dc649de0.jpg. Annotated image saved.\n","Processed b3c4e98b-0c191966.jpg. Annotated image saved.\n","Processed bca36352-acc82f86.jpg. Annotated image saved.\n","Processed c0cb2de6-501299c6.jpg. Annotated image saved.\n","Processed bef1fe5a-64664ad2.jpg. Annotated image saved.\n","Processed b8e675b0-b18c870f.jpg. Annotated image saved.\n","Processed b3048201-d86d9cd8.jpg. Annotated image saved.\n","Processed c1a5825c-0ea22b59.jpg. Annotated image saved.\n","Processed b7db31d1-188d4a34.jpg. Annotated image saved.\n","Processed c002e4d7-fd635384.jpg. Annotated image saved.\n","Processed c4ccffb1-e53dc8ca.jpg. Annotated image saved.\n","Processed c4e5de4b-35f6a1b1.jpg. Annotated image saved.\n","Processed bfacd805-eb6140c4.jpg. Annotated image saved.\n","Processed c6b45cee-d74b5791.jpg. Annotated image saved.\n","Processed b4599849-8379f0de.jpg. Annotated image saved.\n","Processed ba508231-1b6ab5b0.jpg. Annotated image saved.\n","Processed c4ccd765-48590402.jpg. Annotated image saved.\n","Processed c74fff46-bcbcf958.jpg. Annotated image saved.\n","Processed c78f7d9c-783ee02d.jpg. Annotated image saved.\n","Processed c44f673a-b4b48b84.jpg. Annotated image saved.\n","Processed bed4ed94-7b8c51c7.jpg. Annotated image saved.\n","Processed c4b3ce3d-6e999bfc.jpg. Annotated image saved.\n","Processed b8ecdc10-763b27b8.jpg. Annotated image saved.\n","Processed b83b8572-29d97c92.jpg. Annotated image saved.\n","Processed be62c9ed-524c83e8.jpg. Annotated image saved.\n","Processed b3b2ffbe-cd80cda8.jpg. Annotated image saved.\n","Processed bdcd6f24-0b1af2bf.jpg. Annotated image saved.\n","Processed c1f2bf8e-0364535d.jpg. Annotated image saved.\n","Processed b541e2e6-f5256160.jpg. Annotated image saved.\n","Processed bbe57528-3722fc17.jpg. Annotated image saved.\n","Processed c4b610ae-f75d91a9.jpg. Annotated image saved.\n","Processed b979b89c-b359ef70.jpg. Annotated image saved.\n","Processed beb712cc-6594b626.jpg. Annotated image saved.\n","Processed c2e3fe05-6c12de55.jpg. Annotated image saved.\n","Processed bdae005f-7823c05b.jpg. Annotated image saved.\n","Processed c338bae4-b6f47a90.jpg. Annotated image saved.\n","Processed c7053a50-d465ffa3.jpg. Annotated image saved.\n","Processed c52f53f8-f2c94064.jpg. Annotated image saved.\n","Processed c0b30dae-548c5972.jpg. Annotated image saved.\n","Processed c874ddc1-d660401e.jpg. Annotated image saved.\n","Processed bfea6630-1ddff719.jpg. Annotated image saved.\n","Processed bdb95837-0c2e3b2b.jpg. Annotated image saved.\n","Processed c9dc0649-b5aa2483.jpg. Annotated image saved.\n","Processed b784ff27-14060d57.jpg. Annotated image saved.\n","Processed befce81b-f743c561.jpg. Annotated image saved.\n","Processed b6c938b0-a748acc1.jpg. Annotated image saved.\n","Processed b981e7e3-e965dc31.jpg. Annotated image saved.\n","Processed c8620a67-55f86ae2.jpg. Annotated image saved.\n","Processed c417a291-b8079637.jpg. Annotated image saved.\n","Processed bfe52f47-395aca52.jpg. Annotated image saved.\n","Processed be41362b-f6a4eb1c.jpg. Annotated image saved.\n","Processed c2f06deb-e3f1630a.jpg. Annotated image saved.\n","Processed bff76a29-d83cd75e.jpg. Annotated image saved.\n","Processed c87a634a-bacc0924.jpg. Annotated image saved.\n","Processed b4ed5563-e22cb18a.jpg. Annotated image saved.\n","Processed b869965a-5dbee4b1.jpg. Annotated image saved.\n","Processed b9fb5382-de164886.jpg. Annotated image saved.\n","Processed c2ccdd66-47e6d7cd.jpg. Annotated image saved.\n","Processed c71de7ef-ad5d9110.jpg. Annotated image saved.\n","Processed c9aa50be-9e8cd399.jpg. Annotated image saved.\n","Processed c690ecdd-3bb51114.jpg. Annotated image saved.\n","Processed bbf69eae-71b25b22.jpg. Annotated image saved.\n","Processed ca1b1f3e-64dd9b2a.jpg. Annotated image saved.\n","Processed ca0de85e-53bdd171.jpg. Annotated image saved.\n","Processed c513195c-6ff34daf.jpg. Annotated image saved.\n","Processed c5179971-6c0bbf66.jpg. Annotated image saved.\n","Processed bb8dba97-bfa8dcd2.jpg. Annotated image saved.\n","Processed bcbb5f4d-93c5f35d.jpg. Annotated image saved.\n","Processed c64d742b-b58c8bc3.jpg. Annotated image saved.\n","Processed c7dd6716-f165ff52.jpg. Annotated image saved.\n","Processed bcaf73c1-f32b1d31.jpg. Annotated image saved.\n","Processed c97c4556-6055e106.jpg. Annotated image saved.\n","Processed bae4f394-d4a6c04a.jpg. Annotated image saved.\n","Processed b9ecc316-529acd3c.jpg. Annotated image saved.\n","Processed c1a5825c-16222044.jpg. Annotated image saved.\n","Processed c6ca7b50-4238e038.jpg. Annotated image saved.\n","Processed c89ee093-58ed3db1.jpg. Annotated image saved.\n","Processed b8bb2022-6ef7291e.jpg. Annotated image saved.\n","Processed ba0d2a3f-0c429b61.jpg. Annotated image saved.\n","Processed bd812175-d418c63b.jpg. Annotated image saved.\n","Processed b565d4cc-2e6cb390.jpg. Annotated image saved.\n","Processed c1a5825c-7b895437.jpg. Annotated image saved.\n","Processed bc11304f-da51cfda.jpg. Annotated image saved.\n","Processed c8c97803-657086fb.jpg. Annotated image saved.\n","Processed c1b16eee-d45c1777.jpg. Annotated image saved.\n","Processed b2fbf86d-d5de82a4.jpg. Annotated image saved.\n","Processed be2c66b0-2bc5eec8.jpg. Annotated image saved.\n","Processed c11f4171-18d042d3.jpg. Annotated image saved.\n","Processed bd355fcc-866c64d7.jpg. Annotated image saved.\n","Processed be52b29f-aa3b290b.jpg. Annotated image saved.\n","Processed c5ed5d69-f2a3b0ed.jpg. Annotated image saved.\n","Processed c08d18c6-6d211ae8.jpg. Annotated image saved.\n","Processed b214d1e1-f248c616.jpg. Annotated image saved.\n","Processed b48a6dea-df402aaa.jpg. Annotated image saved.\n","Processed b9c66ce6-57fa7e69.jpg. Annotated image saved.\n","Processed ca513280-e4ec496c.jpg. Annotated image saved.\n","Processed c517c182-52118b0a.jpg. Annotated image saved.\n","Processed bd1e4e5b-694e62a6.jpg. Annotated image saved.\n","Processed c16613ce-b065ed48.jpg. Annotated image saved.\n","Processed bb4fca33-008f9178.jpg. Annotated image saved.\n","Processed c356bbec-0c1293f7.jpg. Annotated image saved.\n","Processed c976aa56-2902a314.jpg. Annotated image saved.\n","Processed b5a09604-b79f0f6e.jpg. Annotated image saved.\n","Processed c81974c0-1e531dae.jpg. Annotated image saved.\n","Processed c4097a21-ed514c08.jpg. Annotated image saved.\n","Processed c1f35f18-b78de93e.jpg. Annotated image saved.\n","Processed bf54973d-ad129b06.jpg. Annotated image saved.\n","Processed c4c7fdec-ec322a67.jpg. Annotated image saved.\n","Processed b6c6e6fe-1c5ab635.jpg. Annotated image saved.\n","Processed bb9a3460-97d249c3.jpg. Annotated image saved.\n","Processed b48fc70b-b1a801f2.jpg. Annotated image saved.\n","Processed b8ef1613-cabb90be.jpg. Annotated image saved.\n","Processed b2939bf0-221e1dfb.jpg. Annotated image saved.\n","Processed b3d54db3-9ac260a3.jpg. Annotated image saved.\n","Processed bedb6dc2-777e4568.jpg. Annotated image saved.\n","Processed bf9460c0-65fea53a.jpg. Annotated image saved.\n","Processed c0a6cfd6-a2f01374.jpg. Annotated image saved.\n","Processed c4ee0cc4-b7af9602.jpg. Annotated image saved.\n","Processed c08bf392-3d39a1bc.jpg. Annotated image saved.\n","Processed c7eab2ff-29602d7b.jpg. Annotated image saved.\n","Processed bf2e0bca-9689bbb7.jpg. Annotated image saved.\n","Processed bab0332c-b043a76c.jpg. Annotated image saved.\n","Processed b406dc5a-7a946e61.jpg. Annotated image saved.\n","Processed c264943c-5e493c9f.jpg. Annotated image saved.\n","Processed c94ceb93-5b8608c4.jpg. Annotated image saved.\n","Processed b1d0a191-65deaeef.jpg. Annotated image saved.\n","Processed c1f39934-7fc50bd1.jpg. Annotated image saved.\n","Processed b24d283f-33783d1b.jpg. Annotated image saved.\n","Processed b7db31d1-fa13a84a.jpg. Annotated image saved.\n","Processed b24702e3-f56e0731.jpg. Annotated image saved.\n","Processed c2b760c8-952a9da4.jpg. Annotated image saved.\n","Processed ca28f275-df2e6ad2.jpg. Annotated image saved.\n","Processed c909551e-fb24caeb.jpg. Annotated image saved.\n","Processed bdbd6b9f-c0f31952.jpg. Annotated image saved.\n","Processed ba635a0a-fd69cb62.jpg. Annotated image saved.\n","Processed ba4fbdd7-43dccdf9.jpg. Annotated image saved.\n","Processed b2d3510a-659ae4de.jpg. Annotated image saved.\n","Processed b645271a-42c7ec52.jpg. Annotated image saved.\n","Processed c79687a5-c8dae3f7.jpg. Annotated image saved.\n","Processed b487a2fa-b74b81bc.jpg. Annotated image saved.\n","Processed c447f74e-64671040.jpg. Annotated image saved.\n","Processed c425e76b-ef2256e0.jpg. Annotated image saved.\n","Processed b6d2717a-a24fc378.jpg. Annotated image saved.\n","Processed bd355fcc-6e341b88.jpg. Annotated image saved.\n","Processed c4a6cc43-f689c9f1.jpg. Annotated image saved.\n","Processed c52f53f8-83f49a86.jpg. Annotated image saved.\n","Processed b1d8735d-eee9f184.jpg. Annotated image saved.\n","Processed c748c1a1-04115595.jpg. Annotated image saved.\n","Processed c8d2ec66-6f31d0dc.jpg. Annotated image saved.\n","Processed c8ddb7b2-8c453f30.jpg. Annotated image saved.\n","Processed b4aefa17-93a7efac.jpg. Annotated image saved.\n","Processed c89fc3e2-aaab0dfb.jpg. Annotated image saved.\n","Processed bdd20a54-d852fa69.jpg. Annotated image saved.\n","Processed c4af195c-45288c26.jpg. Annotated image saved.\n","Processed bb9e9d40-1d4d54db.jpg. Annotated image saved.\n","Processed b7c48676-355433ae.jpg. Annotated image saved.\n","Processed c70a8ace-931896fd.jpg. Annotated image saved.\n","Processed b2638d82-062aa1de.jpg. Annotated image saved.\n","Processed b90bcbaa-d26f06dc.jpg. Annotated image saved.\n","Processed bae16c60-044a4822.jpg. Annotated image saved.\n","Processed c59500f0-130d7415.jpg. Annotated image saved.\n","Processed c09b6e1f-e23f6359.jpg. Annotated image saved.\n","Processed c48f5464-ebc458bf.jpg. Annotated image saved.\n","Processed b6aa41ba-04780705.jpg. Annotated image saved.\n","Processed b7c48676-d61a6e81.jpg. Annotated image saved.\n","Processed bba066cf-355f858a.jpg. Annotated image saved.\n","Processed c9b55e48-8c2b4097.jpg. Annotated image saved.\n","Processed c4396376-b6de614b.jpg. Annotated image saved.\n","Processed c35e0eea-7596f0bd.jpg. Annotated image saved.\n","Processed bee6f1ed-1a33ed88.jpg. Annotated image saved.\n","Processed c675081b-c71e159b.jpg. Annotated image saved.\n","Processed c0c63f02-77b9b06d.jpg. Annotated image saved.\n","Processed b1d968b9-ce42734f.jpg. Annotated image saved.\n","Processed c9aa50be-62caa81b.jpg. Annotated image saved.\n","Processed c6864b90-0632ce1d.jpg. Annotated image saved.\n","Processed b81b8523-57ccb331.jpg. Annotated image saved.\n","Processed c15c29a5-6881956e.jpg. Annotated image saved.\n","Processed b1db7e22-cfa74dc3.jpg. Annotated image saved.\n","Processed c2680d40-90d19d17.jpg. Annotated image saved.\n","Processed b93e2268-40e27a6d.jpg. Annotated image saved.\n","Processed c2c78435-e0e98f96.jpg. Annotated image saved.\n","Processed c1a5825c-f41039d1.jpg. Annotated image saved.\n","Processed c8d3c68c-da2089e8.jpg. Annotated image saved.\n","Processed c0a6cfd6-0c600d1f.jpg. Annotated image saved.\n","Processed b6aa41ba-6ac62da0.jpg. Annotated image saved.\n","Processed beced1e4-e2532a6e.jpg. Annotated image saved.\n","Processed b87ca2c5-c3c6e7ce.jpg. Annotated image saved.\n","Processed b70c8fba-827bc9c7.jpg. Annotated image saved.\n","Processed bc79227e-28da8a63.jpg. Annotated image saved.\n","Processed b3a6f586-21d97cce.jpg. Annotated image saved.\n","Processed c6af1e13-28b184aa.jpg. Annotated image saved.\n","Processed bb9071ac-46abc696.jpg. Annotated image saved.\n","Processed c396e833-890b7ddb.jpg. Annotated image saved.\n","Processed b3e2086f-d41fbd4d.jpg. Annotated image saved.\n","Processed bfd64d5f-a12327b4.jpg. Annotated image saved.\n","Processed b5296e2a-37df633f.jpg. Annotated image saved.\n","All images processed. Annotations saved in /content/drive/MyDrive/shared-data/Notebook datafiles/Street-view-datasets/Geo-dataset/pre-trained-anno-2\n"]}],"source":["# Process images\n","process_images_in_folder(input_folder_path, output_folder_path)"]},{"cell_type":"markdown","metadata":{"id":"492cgYUYWLkN"},"source":["## Module: Visualizing a Subset of the Annotated Images for Review"]},{"cell_type":"markdown","source":["Importing the following libraries will enable the script to display a random subset of the newly annotated images.The Plotly Express (`plotly.express`) module is particularly useful for creating interactive visualizations such as the ones generated in this script."],"metadata":{"id":"ndIRwU_AqUiT"}},{"cell_type":"code","source":["import plotly.express as px\n","import os\n","from PIL import Image\n","import numpy as np\n","import random"],"metadata":{"id":"5mVtXThOqBe7"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["The `load_image` function loads an image from the specified file path and converts it to a NumPy array. The image is then opened and assigned to the `img` variable using a context manager to ensure that it is properly closed after the block of code is executed, even if any errors occur. The image is then converted to a three-dimensional NumPy array and returned at the end of the code block."],"metadata":{"id":"JEY-4E2EqU6d"}},{"cell_type":"code","source":["def load_image(image_path):\n","    \"\"\"Load an image from a file path.\"\"\"\n","    with Image.open(image_path) as img:\n","        return np.array(img)"],"metadata":{"id":"Rp6OVruTqCRj"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["The `interactive_visualization` function begins by creating a list of the valid file names in the specified directory, and then filters them to only include image files ending in .png, .jpg, or .jpeg. The ‘if’ block ensures that there are images within the directory after which the `random` module is used to select a subset of images and store them in the `selected_files_subset` variable. The subset of images is then displayed with the image names as the plot titles using the `Plotly` library."],"metadata":{"id":"cauDL6OxqVPV"}},{"cell_type":"code","source":["def interactive_visualization(directory, subset_size=4): #the subset value can be modified according to the desired number of images\n","    # Getting the list of image file names that ends with the specified extensions\n","    image_files = [file for file in os.listdir(directory) if file.endswith(('.png', '.jpg', '.jpeg'))]\n","\n","    if not image_files:\n","        print(\"No images found in the directory.\")\n","        return\n","\n","    # Select a subset of images from the list of image files\n","    selected_files_subset = random.sample(image_files, min(subset_size, len(image_files)))\n","\n","    # Display selected images using Plotly\n","    for image_file in selected_files_subset:\n","        image_path = os.path.join(directory, image_file)\n","        image = load_image(image_path)\n","        fig = px.imshow(image)\n","        fig.update_layout(title_text=f'Selected Image: {image_file}', margin=dict(l=10, r=10, t=40, b=10))\n","        fig.show()"],"metadata":{"id":"eDUzqe2fqG1X"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["The `interactive_visualization` function is then called with the annotated image directory as the argument."],"metadata":{"id":"oStgbjtOqVzp"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"1Ul-0vR2PGNPzIENHE3F7UzL7KgGkF5wS"},"executionInfo":{"elapsed":17010,"status":"ok","timestamp":1718730721553,"user":{"displayName":"Ryleigh Bruce","userId":"04866625339349492872"},"user_tz":300},"id":"HtngepZuWcx-","outputId":"f3aa8d5a-8c96-48b2-86aa-9664bc19f502"},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["interactive_visualization('/content/drive/MyDrive/shared-data/Notebook datafiles/Street-view-datasets/Geo-dataset/pre-trained-anno-2')"]}],"metadata":{"colab":{"provenance":[],"collapsed_sections":["ysby5TACXykc","CO8v6QZr5hW1","feLMBno_LDWT","NyVnVLctL5PE"]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}